%% Exercise 3.2 %%

for ii = 1:100
    e31
    % ar2cov solves for r(k) in YW given that we know the AR parameters!
    SigmaYY = toeplitz(ar2cov(p1, sigma2, K-1));
    SigmaYx = ar2cov(p2, sigma2noise, K-1);
    theta_opt = SigmaYx \ SigmaYY;

    error(i) = x(end)-theta_opt*y
    
    derror(i) = x(end) - y(end)
end

mean_e = mean(error)
var_e = var(error)

mean_d = mean(derror)
var_d = mean(derror)